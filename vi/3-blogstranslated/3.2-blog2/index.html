<!doctype html><html lang=vi class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=../../../images/favicon.png type=image/png><title>Blog 2 :: Báo cáo thực tập</title>
<link href=../../../css/nucleus.css?1765391756 rel=stylesheet><link href=../../../css/fontawesome-all.min.css?1765391756 rel=stylesheet><link href=../../../css/hybrid.css?1765391756 rel=stylesheet><link href=../../../css/featherlight.min.css?1765391756 rel=stylesheet><link href=../../../css/perfect-scrollbar.min.css?1765391756 rel=stylesheet><link href=../../../css/auto-complete.css?1765391756 rel=stylesheet><link href=../../../css/atom-one-dark-reasonable.css?1765391756 rel=stylesheet><link href=../../../css/theme.css?1765391756 rel=stylesheet><link href=../../../css/hugo-theme.css?1765391756 rel=stylesheet><link href=../../../css/theme-workshop.css?1765391756 rel=stylesheet><script src=../../../js/jquery-3.3.1.min.js?1765391756></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../../vi/3-blogstranslated/3.2-blog2/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../../js/lunr.min.js?1765391756></script><script type=text/javascript src=../../../js/auto-complete.js?1765391756></script><script type=text/javascript>var baseurl="https://domint1.github.io/FCJ-Internship-Report//vi"</script><script type=text/javascript src=../../../js/search.js?1765391756></script></div><div class=highlightable><ul class=topics><li data-nav-id=/vi/1-worklog/ title="Nhật ký công việc" class=dd-item><a href=../../../vi/1-worklog/><b>1. </b>Nhật ký công việc
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/1-worklog/1.1-week1/ title="Worklog Tuần 1" class=dd-item><a href=../../../vi/1-worklog/1.1-week1/><b>1.1. </b>Worklog Tuần 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.2-week2/ title="Worklog Tuần 2" class=dd-item><a href=../../../vi/1-worklog/1.2-week2/><b>1.2. </b>Worklog Tuần 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.3-week3/ title="Worklog Tuần 3" class=dd-item><a href=../../../vi/1-worklog/1.3-week3/><b>1.3. </b>Worklog Tuần 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.4-week4/ title="Worklog Tuần 4" class=dd-item><a href=../../../vi/1-worklog/1.4-week4/><b>1.4. </b>Worklog Tuần 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.5-week5/ title="Worklog Tuần 5" class=dd-item><a href=../../../vi/1-worklog/1.5-week5/><b>1.5. </b>Worklog Tuần 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.6-week6/ title="Worklog Tuần 6" class=dd-item><a href=../../../vi/1-worklog/1.6-week6/><b>1.6. </b>Worklog Tuần 6
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.7-week7/ title="Worklog Tuần 7" class=dd-item><a href=../../../vi/1-worklog/1.7-week7/><b>1.7. </b>Worklog Tuần 7
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.8-week8/ title="Worklog Tuần 8" class=dd-item><a href=../../../vi/1-worklog/1.8-week8/><b>1.8. </b>Worklog Tuần 8
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.9-week9/ title="Worklog Tuần 9" class=dd-item><a href=../../../vi/1-worklog/1.9-week9/><b>1.9. </b>Worklog Tuần 9
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.10-week10/ title="Worklog Tuần 10" class=dd-item><a href=../../../vi/1-worklog/1.10-week10/><b>1.10. </b>Worklog Tuần 10
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.11-week11/ title="Worklog Tuần 11" class=dd-item><a href=../../../vi/1-worklog/1.11-week11/><b>1.11. </b>Worklog Tuần 11
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.12-week12/ title="Worklog Tuần 12" class=dd-item><a href=../../../vi/1-worklog/1.12-week12/><b>1.12 </b>Worklog Tuần 12
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/2-proposal/ title="Bản đề xuất" class=dd-item><a href=../../../vi/2-proposal/><b>2. </b>Bản đề xuất
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/ title="Các bài blogs đã dịch" class="dd-item
parent"><a href=../../../vi/3-blogstranslated/><b>3. </b>Các bài blogs đã dịch
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/3-blogstranslated/3.1-blog1/ title="Blog 1" class=dd-item><a href=../../../vi/3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.2-blog2/ title="Blog 2" class="dd-item
active"><a href=../../../vi/3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.3-blog3/ title="Blog 3" class=dd-item><a href=../../../vi/3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/4-eventparticipated/ title="Các events đã tham gia" class=dd-item><a href=../../../vi/4-eventparticipated/><b>4. </b>Các events đã tham gia
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/4-eventparticipated/4.1-event1/ title="Event 1" class=dd-item><a href=../../../vi/4-eventparticipated/4.1-event1/><b>4.1. </b>Event 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.2-event2/ title="Event 2" class=dd-item><a href=../../../vi/4-eventparticipated/4.2-event2/><b>4.2. </b>Event 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.3-event3/ title="Event 3" class=dd-item><a href=../../../vi/4-eventparticipated/4.3-event3/><b>4.3. </b>Event 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.4-event4/ title="Event 3" class=dd-item><a href=../../../vi/4-eventparticipated/4.4-event4/><b>4.3. </b>Event 3
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/ title=Workshop class=dd-item><a href=../../../vi/5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.1-workshop-overview/ title="Tổng Quan Workshop" class=dd-item><a href=../../../vi/5-workshop/5.1-workshop-overview/><b>5.1. </b>Tổng Quan Workshop
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.2-prerequiste/ title="Các bước chuẩn bị" class=dd-item><a href=../../../vi/5-workshop/5.2-prerequiste/><b>5.2. </b>Các bước chuẩn bị
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.3-aws-cognito/ title="Thiết lập AWS Cognito" class=dd-item><a href=../../../vi/5-workshop/5.3-aws-cognito/><b>5.3. </b>Thiết lập AWS Cognito
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.3-aws-cognito/5.3.1-create-cognito/ title="Tạo Cognito User Pool" class=dd-item><a href=../../../vi/5-workshop/5.3-aws-cognito/5.3.1-create-cognito/><b>5.3.1 </b>Tạo Cognito User Pool
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.3-aws-cognito/5.3.2-configure-appclient/ title="Cấu hình App Client" class=dd-item><a href=../../../vi/5-workshop/5.3-aws-cognito/5.3.2-configure-appclient/><b>5.3.2 </b>Cấu hình App Client
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.4-next.js-setup/ title="Thiết lập dự án Next.js & Cấu hình Amplify" class=dd-item><a href=../../../vi/5-workshop/5.4-next.js-setup/><b>5.4. </b>Thiết lập dự án Next.js & Cấu hình Amplify
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.4-next.js-setup/5.4.1-install-nextjs/ title="Cài đặt dự án Next.js" class=dd-item><a href=../../../vi/5-workshop/5.4-next.js-setup/5.4.1-install-nextjs/><b>5.4.1 </b>Cài đặt dự án Next.js
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.4-next.js-setup/5.4.2-install-amplify/ title="Cài đặt Amplify SDK và Cấu hình Amplify" class=dd-item><a href=../../../vi/5-workshop/5.4-next.js-setup/5.4.2-install-amplify/><b>5.4.2 </b>Cài đặt Amplify SDK và Cấu hình Amplify
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.5-cognito-function/ title="Authentication Functions, UI và Protected Routes" class=dd-item><a href=../../../vi/5-workshop/5.5-cognito-function/><b>5.5. </b>Authentication Functions, UI và Protected Routes
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.5-cognito-function/5.5.1-auth-functions/ title="Tạo Authentication Functions" class=dd-item><a href=../../../vi/5-workshop/5.5-cognito-function/5.5.1-auth-functions/><b>5.5.1 </b>Tạo Authentication Functions
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.5-cognito-function/5.5.2-auth-ui/ title="Xây dựng Authentication UI" class=dd-item><a href=../../../vi/5-workshop/5.5-cognito-function/5.5.2-auth-ui/><b>5.5.2 </b>Xây dựng Authentication UI
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.5-cognito-function/5.5.4-use-project-demo/ title="Sử dụng demo project cho cognito authentication" class=dd-item><a href=../../../vi/5-workshop/5.5-cognito-function/5.5.4-use-project-demo/><b>5.5.4 </b>Sử dụng demo project cho cognito authentication
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.5-cognito-function/5.5.3-protected-routes/ title="Triển khai Auth Context & Protected Routes" class=dd-item><a href=../../../vi/5-workshop/5.5-cognito-function/5.5.3-protected-routes/><b>5.5.3 </b>Triển khai Auth Context & Protected Routes
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.6-testing/ title="Kiểm tra & Xác minh đầy đủ" class=dd-item><a href=../../../vi/5-workshop/5.6-testing/><b>5.6 </b>Kiểm tra & Xác minh đầy đủ
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.7-cleanup/ title="5.7 Dọn dẹp tài nguyên" class=dd-item><a href=../../../vi/5-workshop/5.7-cleanup/><b>5.7 </b>5.7 Dọn dẹp tài nguyên
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/6-self-evaluation/ title="Tự đánh giá" class=dd-item><a href=../../../vi/6-self-evaluation/><b>6. </b>Tự đánh giá
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/7-feedback/ title="Chia sẻ, đóng góp ý kiến" class=dd-item><a href=../../../vi/7-feedback/><b>7. </b>Chia sẻ, đóng góp ý kiến
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://domint1.github.io/FCJ-Internship-Report/3-blogstranslated/3.2-blog2/>English</option><option id=vi value=https://domint1.github.io/FCJ-Internship-Report/vi/3-blogstranslated/3.2-blog2/ selected>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../../vi/>Báo cáo thực tập</a> > <a href=../../../vi/3-blogstranslated/>Các bài blogs đã dịch</a> > Blog 2</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#giới-thiệu>Giới thiệu</a></li><li><a href=#tổng-quan-về-giải-pháp>Tổng quan về giải pháp</a></li><li><a href=#yêu-cầu-trước-khi-thực-hiện>Yêu cầu trước khi thực hiện</a></li><li><a href=#triển-khai-giải-pháp-với-aws-cdk>Triển khai giải pháp với AWS CDK</a></li><li><a href=#hướng-dẫn-chi-tiết-về-giải-pháp>Hướng dẫn chi tiết về giải pháp</a></li><li><a href=#giải-thích-chi-tiết-về-việc-tương-quan-trace-trace-correlation>Giải thích chi tiết về việc tương quan trace (Trace Correlation)</a></li><li><a href=#khái-niệm-về-distributed-tracing>Khái niệm về Distributed Tracing</a></li><li><a href=#cấu-hình-opentelemetry-collector>Cấu hình OpenTelemetry Collector</a></li><li><a href=#dọn-dẹp-tài-nguyên>Dọn dẹp tài nguyên</a></li><li><a href=#kết-luận>Kết luận</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 2</h1><h1 id=theo-dõi-quy-trình-etl-với-aws-x-ray-và-aws-distro-for-opentelemetry>Theo dõi quy trình ETL với AWS X-Ray và AWS Distro for OpenTelemetry</h1><p><strong>Tác giả</strong>: <em>Praneeth Reddy Tekula, Deepak Kovvuri, và Viveyk Karri</em></p><p><strong>Ngày đăng</strong>:<em>30 tháng 8, 2025</em></p><p><em>Chuyên mục:</em> <a href=https://aws.amazon.com/blogs/mt/category/management-tools/aws-distro-for-opentelemetry/><em>AWS Distro for OpenTelemetry</em></a><em>,</em> <a href=https://aws.amazon.com/blogs/mt/category/analytics/aws-glue/><em>AWS Glue</em></a><em>,</em> <a href=https://aws.amazon.com/blogs/mt/category/developer-tools/aws-x-ray/><em>AWS X-Ray</em></a><em>,</em> <a href=https://aws.amazon.com/blogs/mt/category/management-tools/><em>Management Tools</em></a><em>,</em> <a href=https://aws.amazon.com/blogs/mt/category/post-types/technical-how-to/><em>Technical How-to</em></a></p><h2 id=giới-thiệu>Giới thiệu</h2><p>Các data pipeline là yếu tố thiết yếu đối với các công ty định hướng dữ liệu hiện đại nhằm thu được những insight kinh doanh quan trọng. Tuy nhiên, các pipeline này thường gặp lỗi khi những file hoặc dataset mới từ nguồn dữ liệu không tuân theo schema mong đợi, dẫn đến việc các job ở tầng downstream bị lỗi, workflow bị gián đoạn, và việc tạo ra insight bị trì hoãn. Bên cạnh đó, sự dao động của khối lượng dữ liệu — từ vài gigabyte đến hàng terabyte — có thể ảnh hưởng đáng kể đến hiệu suất và độ tin cậy của các pipeline này. Điều này khiến việc xác định ETL job cụ thể bị lỗi trong toàn bộ pipeline trở nên khó khăn hơn đối với người dùng.</p><p>Để giải quyết những thách thức này, việc giám sát data pipeline theo thời gian thực và duy trì góc nhìn end-to-end là rất quan trọng nhằm phát hiện sớm sự cố và giảm thiểu gián đoạn. Trong bài viết này, chúng ta sẽ cùng tìm hiểu cách orchestrate một ETL pipeline end-to-end bằng cách sử dụng <a href=https://aws.amazon.com/glue>AWS Glue</a>, <a href=https://aws.amazon.com/pm/step-functions/>AWS Step Functions</a>, <a href=http://aws.amazon.com/s3>Amazon Simple Storage Service</a> (Amazon S3), <a href=https://aws.amazon.com/otel/>AWS Distro for OpenTelemetry</a> (ADOT) và <a href=https://aws.amazon.com/xray/>AWS X-Ray</a>.</p><h2 id=tổng-quan-về-giải-pháp>Tổng quan về giải pháp</h2><p>Giải pháp này giải quyết một trường hợp sử dụng trong kỹ thuật dữ liệu (data engineering) với cách tiếp cận pipeline hai giai đoạn:</p><ul><li><strong>Giai đoạn làm sạch dữ liệu (Data Cleaning)</strong>: Giai đoạn làm sạch dữ liệu được xử lý bởi một ETL job để chuyển đổi các định dạng dữ liệu tùy ý (CSV, JSON) sang Parquet và thực hiện nhiều phép biến đổi (transformations) khác nhau, bao gồm chuẩn hóa tên cột (standardizing column names), loại bỏ các cột không cần thiết (dropping unnecessary columns), xóa các bản ghi trùng lặp (removing duplicates), điền các giá trị null (filling null values), chuyển đổi các kiểu dữ liệu (converting data types), và khắc phục độ lệch (fixing skewness) trong một số cột nhất định.</li><li><strong>Giai đoạn xử lý dữ liệu (Data Processing)</strong>: Tiếp theo, giai đoạn xử lý dữ liệu được xử lý bởi một ETL job khác, có nhiệm vụ tính toán, xếp hạng và nhóm dữ liệu.</li></ul><p>Data pipeline được điều phối từ đầu đến cuối (end to end) bằng AWS Step Functions, tận dụng AWS Glue cho các ETL job được tích hợp ADOT và X-ray helper model tùy chỉnh để có khả năng truy vết toàn diện (comprehensive tracing). Hình (1) minh họa các thành phần kiến trúc liên quan đến việc điều phối một ETL pipeline end-to-end. Cách thức hoạt động như sau:</p><ol><li>Tải một dataset lên S3 bucket bằng cách tạo một thư mục input.</li><li>Thao tác này kích hoạt lambda function, khởi tạo một X-Ray trace mới và gọi Step Function workflow bằng cách truyền <code>traceID</code> và chi tiết đối tượng S3 làm đầu vào (input).</li><li>Step Function workflow truyền <code>traceID</code> này dưới dạng một tham số. Glue Jobs sử dụng X-ray helper module để truy xuất parent segment cho job hiện tại và tương quan với input <code>traceID</code> từ step functions.</li><li>Glue Job – 1 tìm nạp input data set từ S3 bucket để thực hiện data cleaning và tải đầu ra (output) lên cùng một bucket bằng cách tạo một thư mục clean.</li><li>Sau khi Glue Job – 1 hoàn thành, step function workflow kích hoạt Glue Job – 2.</li><li>Glue Job – 2 tìm nạp input data set từ S3 bucket để thực hiện data processing job và tải đầu ra (output) lên cùng một bucket bằng cách tạo một thư mục processed.</li><li>Mỗi Glue Job được tích hợp ADOT để gửi dữ liệu trace đã thu thập đến OpenTelemetry Collector, chạy dưới dạng một sidecar trên ECS.</li><li>OpenTelemetry Collector sau đó đẩy dữ liệu trace đã thu thập đến AWS X-Ray.</li></ol><figure class=img-box><img src=../../../images/Blog2/Image-1.jpg alt="Solution Architecture"></figure><p style=text-align:center>Hình 1: Solution Architecture</p><p>Nhờ cách này, chúng ta duy trì một trace duy nhất xuyên suốt pipeline ETL, giúp mọi người có thể nhìn thấy luồng dữ liệu end-to-end. Các kỹ sư dữ liệu và người làm MLOps có thể có insight sâu, nhanh chóng xác định điểm tắc nghẽn hoặc lỗi, và tối ưu hóa workflow để tăng hiệu quả và độ tin cậy.</p><h2 id=yêu-cầu-trước-khi-thực-hiện>Yêu cầu trước khi thực hiện</h2><p>Để triển khai giải pháp này, bạn cần:</p><ul><li>Một tài khoản AWS. Nếu bạn chưa có, bạn có thể <a href=https://aws.amazon.com/>tạo một tài khoản</a>.</li><li>Một <a href=http://aws.amazon.com/iam>AWS Identity and Access Management (IAM)</a> role để khởi tạo template <a href=http://aws.amazon.com/cloudformation>CloudFormation</a>, tạo các role IAM cần thiết để truy cập các dịch vụ như <a href=https://aws.amazon.com/glue>AWS Glue</a>, <a href=https://aws.amazon.com/xray/>AWS X-Ray</a>, <a href=https://aws.amazon.com/step-functions/>AWS Step Functions</a>, <a href=https://aws.amazon.com/pm/lambda/>AWS Lambda</a>, <a href=https://aws.amazon.com/ecs/>Amazon ECS</a>, <a href=https://aws.amazon.com/cloud-map/>AWS CloudMap</a> và <a href=http://aws.amazon.com/s3>Amazon Simple Storage Service</a>.</li><li>Cài đặt <a href=https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html>AWS CLI</a>.</li><li>Python 3.12 hoặc mới hơn.</li><li>Cài đặt <a href=https://docs.aws.amazon.com/cdk/v2/guide/getting_started.html#getting_started_install>AWS CDK</a>.</li></ul><h2 id=triển-khai-giải-pháp-với-aws-cdk>Triển khai giải pháp với AWS CDK</h2><p>Chúng ta sẽ dùng <a href=https://aws.amazon.com/cdk/>AWS CDK</a> để triển khai giải pháp này. CDK cho phép định nghĩa cơ sở hạ tầng qua một ngôn ngữ lập trình quen thuộc như Python.</p><ol><li>Clone repository:</li></ol><pre tabindex=0><code>git clone &lt;https://github.com/aws-samples/tracing-etl-workloads-otel.git&gt; cd tracing-etl-workloads-otel
</code></pre><ol start=2><li><p>Tạo và kích hoạt môi trường ảo (virtual environment):</p><ul><li>Đối với Linux và macOS:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 -m venv .venv
</span></span><span style=display:flex><span>source .venv/bin/activate
</span></span></code></pre></div></li><li>Đối với Windows:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python -m venv .venv
</span></span><span style=display:flex><span>.venv<span style=color:#ae81ff>\\</span>Scripts<span style=color:#ae81ff>\\</span>activate
</span></span></code></pre></div></li></ul></li><li><p>Cài đặt các dependencies.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip install -r requirements.txt
</span></span></code></pre></div></li><li><p>Bootstrap môi trường CDK (nếu chưa thực hiện).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cdk bootstrap
</span></span></code></pre></div></li><li><p>Triển khai (Deploy) stack.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cdk deploy
</span></span></code></pre></div></li></ol><p>Điều này sẽ tạo các tài nguyên cần thiết, bao gồm: S3 buckets, Glue jobs, Step Functions state machine, and Lambda function. Sau khi triển khai xong, bạn có thể xem các tài nguyên trong console CloudFormation, trong stack “OtelSolutionStack”.</p><h2 id=hướng-dẫn-chi-tiết-về-giải-pháp>Hướng dẫn chi tiết về giải pháp</h2><ol><li>Tải <a href=https://www.kaggle.com/datasets/arianazmoudeh/airbnbopendata>dataset mẫu Airbnb</a> lên S3 ingestion bucket, trong thư mục con (prefix folder).<figure class=img-box><img src=../../../images/Blog2/Image-2.png alt="Solution Architecture"></figure></li></ol><p style=text-align:center>Hình 2: Dataset mẫu đã được tải lên S3 bucket.</p><ol start=2><li>Chờ AWS Step Functions hoàn tất workflow của state machine và trạng thái hiển thị “Succeeded”.</li></ol><figure class=img-box><img src=../../../images/Blog2/Image-3.png alt="Solution Architecture"></figure><p style=text-align:center>Hình 3: Workflow của State Machine đang chạy các Glue Jobs</p><ol start=3><li>Điều hướng đến <a href="https://us-east-2.console.aws.amazon.com/cloudwatch/home?region=us-east-2#home:">AWS CloudWatch Console</a>. Trong thanh điều hướng bên trái, chọn “X-Ray traces”, sau đó chọn <code>traceID</code> gần nhất.</li></ol><figure class=img-box><img src=../../../images/Blog2/Image-4.png alt="Solution Architecture"></figure><p style=text-align:center>Hình 4: Truy xuất Trace trên AWS X-Ray</p><ol start=4><li>Một bản đồ trace (trace map) sẽ được hiển thị mặc định. Đây là biểu diễn trực quan, end-to-end của luồng dữ liệu đi qua từng thành phần trong data pipeline.</li></ol><figure class=img-box><img src=../../../images/Blog2/Image-5.png alt="Solution Architecture"></figure><p style=text-align:center>Hình 5: Trace Map – biểu diễn end-to-end của luồng dữ liệu (data flow)</p><ol start=5><li>Mỗi thành phần, bao gồm AWS Lambda, AWS Step Functions, và AWS Glue, sẽ tạo một segment riêng biệt trong trace.</li></ol><figure class=img-box><img src=../../../images/Blog2/Image-6.png alt="Solution Architecture"></figure><p style=text-align:center>Hình 6: Các Segment trong một Trace</p><ol start=6><li>Bạn sẽ thấy các sub-segment nằm trong AWS Glue Segment, do quá trình instrumentation được thực hiện bằng AWS Distro for OpenTelemetry (ADOT).</li></ol><figure class=img-box><img src=../../../images/Blog2/Image-7.png alt="Solution Architecture"></figure><p style=text-align:center>Hình 7: Các Sub-segment trong AWS Glue Segment</p><ol start=7><li>Mức độ chi tiết này giúp data engineers xác định được thao tác cụ thể nào trong Glue job đang tiêu tốn nhiều thời gian nhất.</li></ol><h2 id=giải-thích-chi-tiết-về-việc-tương-quan-trace-trace-correlation>Giải thích chi tiết về việc tương quan trace (Trace Correlation)</h2><p>Giải pháp sử dụng mô-đun hỗ trợ X-Ray tùy chỉnh để tương quan các trace giữa các phần trong pipeline ETL. Cách hoạt động như sau:</p><ul><li><p><strong>Glue Jobs:</strong></p><ul><li>Khi bắt đầu mỗi job Glue, mô-đun X-Ray helper dùng để lấy segment cha cho job hiện tại:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>xray_trace <span style=color:#f92672>=</span> xray_helper<span style=color:#f92672>.</span>XRayTrace(TRACE_ID)
</span></span><span style=display:flex><span>parent_id <span style=color:#f92672>=</span> xray_trace<span style=color:#f92672>.</span>retrieve_segment_for_step(JOB_NAME)
</span></span></code></pre></div><ul><li>Nếu tìm được segment cha, ta tạo một context mới cho ADOT sử dụng propagator của X-Ray:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>carrier <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;X-Amzn-Trace-Id&#39;</span>: <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Root=</span><span style=color:#e6db74>{</span>xray_trace<span style=color:#f92672>.</span>trace_id<span style=color:#e6db74>}</span><span style=color:#e6db74>;Parent=</span><span style=color:#e6db74>{</span>parent_id<span style=color:#e6db74>}</span><span style=color:#e6db74>;Sampled=1&#34;</span>}
</span></span><span style=display:flex><span>propagator <span style=color:#f92672>=</span> AwsXRayPropagator() context <span style=color:#f92672>=</span> propagator<span style=color:#f92672>.</span>extract(carrier<span style=color:#f92672>=</span>carrier)
</span></span></code></pre></div><ul><li>Việc thực thi job Glue được wrap trong một span với context này:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>with</span> tracer<span style=color:#f92672>.</span>start_as_current_span(<span style=color:#e6db74>&#34;Glue Job Execution&#34;</span>, context<span style=color:#f92672>=</span>context, kind<span style=color:#f92672>=</span>trace<span style=color:#f92672>.</span>SpanKind<span style=color:#f92672>.</span>SERVER):
</span></span><span style=display:flex><span><span style=color:#75715e># Job execution code</span>
</span></span></code></pre></div><ul><li>Trong job, các thao tác riêng biệt được wrap bằng các span con để trace chi tiết hơn:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>with</span> tracer<span style=color:#f92672>.</span>start_as_current_span(<span style=color:#e6db74>&#34;Read Data&#34;</span>, attributes<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;S3Path&#39;</span>: s3_path}):
</span></span><span style=display:flex><span><span style=color:#75715e># Read data operation</span>
</span></span></code></pre></div></li><li><p><strong>Trace Emission:</strong></p><ul><li>Instrumentation ADOT được cấu hình để gửi dữ liệu trace đến OpenTelemetry Collector chạy như sidecar. Collector sau đó gửi dữ liệu trace đến AWS X-Ray:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>processor <span style=color:#f92672>=</span> BatchSpanProcessor(OTLPSpanExporter(endpoint<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;http://</span><span style=color:#e6db74>{</span>OTLP_ENDPOINT<span style=color:#e6db74>}</span><span style=color:#e6db74>:4318/v1/traces&#34;</span>))
</span></span><span style=display:flex><span>tracer_provider <span style=color:#f92672>=</span> TracerProvider(resource<span style=color:#f92672>=</span>resource, active_span_processor<span style=color:#f92672>=</span>processor)
</span></span></code></pre></div></li></ul><p>Nhờ cách này, chúng ta giữ một trace duy nhất xuyên suốt pipeline ETL, từ khi dữ liệu được upload lên S3, qua Step Functions đến các job Glue.</p><h2 id=khái-niệm-về-distributed-tracing>Khái niệm về Distributed Tracing</h2><p>Một số khái niệm quan trọng cần hiểu:</p><ul><li><p><strong>Trace:</strong> Một trace đại diện cho toàn bộ hành trình của một yêu cầu (request) hoặc một hoạt động (operation) khi nó di chuyển qua một hệ thống phân tán. Trong pipeline ETL của chúng ta, một trace bắt đầu khi dữ liệu được tải lên Amazon S3 và kết thúc khi dữ liệu đã được xử lý cuối cùng được ghi trở lại vào Amazon S3.</p></li><li><p><strong>Span:</strong> Thành phần cấu tạo của trace. Mỗi span đại diện cho một đơn vị công việc hay hoạt động trong trace. Ví dụ: trong job Glue, ta tạo span cho các thao tác như “Read Data”, “Drop Columns”, “Calculate Minimum Total Spend”. Span có thời điểm bắt đầu, thời điểm kết thúc và có thể chứa metadata (như logs hoặc tags). Ví dụ từ Glue Job của chúng tôi:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>with</span> tracer<span style=color:#f92672>.</span>start_as_current_span(<span style=color:#e6db74>&#34;Calculate Minimum Total Spend&#34;</span>):
</span></span><span style=display:flex><span>spark_df <span style=color:#f92672>=</span> spark_df<span style=color:#f92672>.</span>withColumn(<span style=color:#e6db74>&#34;minimum_total_spend&#34;</span>, (col(<span style=color:#e6db74>&#34;price&#34;</span>) <span style=color:#f92672>+</span> col(<span style=color:#e6db74>&#34;service_fee&#34;</span>)) <span style=color:#f92672>*</span> col(<span style=color:#e6db74>&#39;minimum_nights&#39;</span>))
</span></span></code></pre></div></li><li><p><strong>Quan hệ Cha – Con (Parent-Child):</strong> Spans có thể có quan hệ cha – con, tạo nên cấu trúc phân cấp trong một trace. Ở giải pháp này, span thực thi Glue job là span cha, và các thao tác bên trong là span con.</p></li><li><p><strong>Segment:</strong> Trong AWS X-Ray, một segment tương đương một span, nhưng nó đại diện cho một đơn vị công việc được thực hiện bởi một thành phần duy nhất trong ứng dụng. (ví dụ: Lambda invocation, Step Functions execution, Glue job run).</p></li><li><p><strong>Subsegment:</strong> Tương đương với span con, đại diện tầng con trong một segment. Trong các Glue jobs của chúng ta, những hoạt động riêng lẻ được theo dõi (trace) sẽ trở thành subsegments trong X-Ray.</p></li><li><p><strong>Trace Context Propagation:</strong> Để duy trì một trace xuyên suốt giữa các thành phần của hệ thống phân tán, cần truyền ngữ cảnh trace (trace context). Điều này cho phép chúng ta liên kết Lambda, Step Functions và các Glue jobs vào cùng một trace. Chúng ta thực hiện điều này bằng cách truyền trace ID và parent segment ID giữa các thành phần. Ví dụ:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>carrier <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;X-Amzn-Trace-Id&#39;</span>: <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Root=</span><span style=color:#e6db74>{</span>xray_trace<span style=color:#f92672>.</span>trace_id<span style=color:#e6db74>}</span><span style=color:#e6db74>;Parent=</span><span style=color:#e6db74>{</span>parent_id<span style=color:#e6db74>}</span><span style=color:#e6db74>;Sampled=1&#34;</span>}
</span></span><span style=display:flex><span>propagator <span style=color:#f92672>=</span> AwsXRayPropagator()
</span></span><span style=display:flex><span>context <span style=color:#f92672>=</span> propagator<span style=color:#f92672>.</span>extract(carrier<span style=color:#f92672>=</span>carrier)
</span></span></code></pre></div></li><li><p><strong>Attributes và Annotations:</strong> Là các cặp key‐value cung cấp thêm ngữ cảnh cho span hoặc segment. Ta sử dụng chúng để thêm thông tin như S3 path, tên job, thống kê dữ liệu. Ví dụ:</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>with</span> tracer<span style=color:#f92672>.</span>start_as_current_span(<span style=color:#e6db74>&#34;Glue Job Execution&#34;</span>, context<span style=color:#f92672>=</span>context, kind<span style=color:#f92672>=</span>trace<span style=color:#f92672>.</span>SpanKind<span style=color:#f92672>.</span>SERVER, attributes<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;job_name&#39;</span>: JOB_NAME, <span style=color:#e6db74>&#39;job_run_id&#39;</span>: JOB_RUN_ID})
</span></span></code></pre></div><ul><li><strong>Sampling:</strong> Trong hệ thống có lưu lượng cao, việc trace mọi yêu cầu là không khả thi. Sampling là phương pháp chỉ trace một phần yêu cầu. AWS X-Ray cung cấp các quy tắc sampling cấu hình được để kiểm soát lượng dữ liệu trace thu thập và lưu trữ.</li></ul><h2 id=cấu-hình-opentelemetry-collector>Cấu hình OpenTelemetry Collector</h2><p>Một thành phần quan trọng trong setup tracing là OpenTelemetry Collector, chạy như sidecar kèm theo các job Glue. Collector chịu trách nhiệm nhận dữ liệu trace từ các job đã instrumentation và chuyển tiếp đến AWS X-Ray.</p><p>Hãy phân tích file cấu hình (otel-agent-config.yaml) để xác định mô hình cấu trúc dịch vụ trong collector:</p><ul><li><strong>Receivers:</strong> Collector được cấu hình để nhận dữ liệu OpenTelemetry Protocol (OTLP) qua gRPC (cổng 4317) và HTTP (cổng 4318). Điều này cho phép job Glue gửi dữ liệu trace theo cả hai giao thức.</li><li><strong>Exporters:</strong> <code>awsxray</code> exporter được cấu hình để gửi dữ liệu trace đã thu thập đến AWS X-Ray. Đây là cách dữ liệu trace của chúng tôi kết thúc bằng việc đưa vào X-Ray để trực quan hóa và phân tích.</li><li><strong>Processors:</strong> Sử dụng bộ giới hạn bộ nhớ (<code>memory_limiter processor</code>) để ngăn collector tiêu tốn quá nhiều bộ nhớ. Giới hạn đặt 100 MiB và kiểm tra mỗi 5 giây.</li></ul><p>Dưới đây là mô hình cấu trúc dịch vụ trong collector:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>receivers</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>otlp</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>protocols</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>grpc</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>endpoint</span>: <span style=color:#ae81ff>0.0.0.0</span>:<span style=color:#ae81ff>4317</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>endpoint</span>: <span style=color:#ae81ff>0.0.0.0</span>:<span style=color:#ae81ff>4318</span>
</span></span><span style=display:flex><span><span style=color:#f92672>exporters</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>awsxray</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>region</span>: <span style=color:#ae81ff>us-east-2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>processors</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>memory_limiter</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>limit_mib</span>: <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>check_interval</span>: <span style=color:#ae81ff>5s</span>
</span></span><span style=display:flex><span><span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>pipelines</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>traces</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>processors</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>memory_limiter</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>receivers</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>otlp</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>exporters</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>awsxray</span>
</span></span></code></pre></div><p>Cấu hình này đảm bảo việc thu thập, xử lý và xuất dữ liệu trace đến AWS X-Ray để quan sát và phân tích pipeline xử lý dữ liệu.</p><h2 id=dọn-dẹp-tài-nguyên>Dọn dẹp tài nguyên</h2><p>Bạn có thể xóa stack bằng console <a href="https://us-east-2.console.aws.amazon.com/cloudformation/home?region=us-east-2#/stacks?filteringText=&filteringStatus=active&viewNested=true">CloudFormation</a> hoặc dùng lệnh sau từ thư mục gốc:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cdk destroy
</span></span></code></pre></div><p>Khi xóa stack, hầu hết các tài nguyên sẽ bị xóa cùng với stack, nhưng có một số ngoại lệ. Trong giải pháp này, các hàm Lambda sẽ tạo ra các log của <a href=https://aws.amazon.com/cloudwatch>Amazon CloudWatch</a> — những log này vẫn được giữ lại ngay cả sau khi stack bị xóa. Các log này sẽ không được CloudFormation theo dõi vì chúng không phải là một phần của stack, do đó chúng sẽ tiếp tục tồn tại. Hãy làm theo các bước được hướng dẫn <a href=https://docs.aws.amazon.com/solutions/latest/video-on-demand-on-aws-foundation/deleting-the-cloudwatch-logs.html>tại đây</a> để xóa thủ công bất kỳ log nào bạn không muốn giữ lại từ giao diện CloudWatch console.</p><h2 id=kết-luận>Kết luận</h2><p>Giải pháp này cung cấp cái nhìn quan sát (observability) end-to-end cho workflow pipeline dữ liệu bằng cách truyền ngữ cảnh và trace các hoạt động cá nhân qua AWS Distro for OpenTelemetry và AWS X-Ray. Điều này giúp kỹ sư dữ liệu nhanh chóng xử lý lỗi, tối ưu hiệu suất và có insight về cách tính chất dữ liệu ảnh hưởng đến quá trình xử lý sau đó. Quan sát này rất quan trọng đối với các nền tảng dữ liệu hiện đại bao gồm workflow phân tán phức tạp qua nhiều thành phần và dịch vụ.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../../vi/3-blogstranslated/3.1-blog1/ title="Blog 1"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../../vi/3-blogstranslated/3.3-blog3/ title="Blog 3" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../../js/clipboard.min.js?1765391756></script><script src=../../../js/perfect-scrollbar.min.js?1765391756></script><script src=../../../js/perfect-scrollbar.jquery.min.js?1765391756></script><script src=../../../js/jquery.sticky.js?1765391756></script><script src=../../../js/featherlight.min.js?1765391756></script><script src=../../../js/highlight.pack.js?1765391756></script><script>hljs.initHighlightingOnLoad()</script><script src=../../../js/modernizr.custom-3.6.0.js?1765391756></script><script src=../../../js/learn.js?1765391756></script><script src=../../../js/hugo-learn.js?1765391756></script><link href=../../../mermaid/mermaid.css?1765391756 rel=stylesheet><script src=../../../mermaid/mermaid.js?1765391756></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>